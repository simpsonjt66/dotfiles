#!/bin/bash

# Launches the default web browser in a new session using uwsm.
# This script is intended to be used by keybindings or other scripts
# to launch the browser in a consistent way.

# Get the default web browser from xdg-settings.
default_browser=$(xdg-settings get default-web-browser)

# Find the Exec command from the browser's .desktop file.
# This handles cases where the Exec key has arguments.
browser_exec=$(sed -n 's/^Exec=\([^ ]*\).*/\1/p' ~/.local/share/applications/"$default_browser" 2>/dev/null | head -1)

# Launch the browser in a new session using uwsm.
# `setsid` ensures the browser is detached from the terminal.
# `uwsm app` launches the application within the Universal Wayland Session Manager,
# ensuring proper integration with the Wayland session.
exec setsid uwsm app -- "$browser_exec"